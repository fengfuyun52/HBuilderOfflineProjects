define(["UILayer",getAppUITemplatePath("ui.bubble.layer")],function(a,b){return _.inherit(a,{propertys:function($super){$super(),this.template=b,this.needMask=!1,this.datamodel={data:[],upClass:"f-layer-before",downClass:"f-layer-after",curClass:"cui-fl-current",index:2,dir:"up"},this.events={"click .cui-f-layer>li":"clickAction"},this.onClick=function(a,b,c){0,this.setIndex(c)},this.width=null,this.triggerEl=null},initialize:function($super,a){$super(a)},createRoot:function(a){this.$el=$(a).hide().attr("id",this.id)},clickAction:function(a){var b=$(a.currentTarget),c=b.attr("data-index"),d=this.datamodel.data[c];this.onClick.call(this,a,d,c,b)},initElement:function(){this.el=this.$el},setIndex:function(a){var b=this.datamodel.curClass;a=parseInt(a),0>a||a>this.datamodel.data.length||a==this.datamodel.index||(this.datamodel.index=a,this.$(".cui-f-layer li").removeClass(b),this.$('li[data-index="'+a+'"]').addClass(b))},reposition:function(){if(this.triggerEl){var a=this.triggerEl.offset(),b=6,c=a.width-b,d=0,e=0;"up"==this.datamodel.dir?(d=a.top+a.height+8+"px",e=a.left+2+"px"):(d=a.top-this.el.offset().height-8+"px",e=a.left+2+"px"),this.el.css({width:this.width||c,top:d,left:e})}},addEvent:function($super){$super(),this.on("onCreate",function(){this.$el.removeClass("cui-layer"),this.$el.css({position:"absolute"})}),this.on("onShow",function(){this.setzIndexTop(this.el)})}})});