define(["UILayer",getAppUITemplatePath("ui.radio.list"),"UIScroll"],function(a,b,c){return _.inherit(a,{propertys:function($super){$super(),this.template=b,this.datamodel={title:"标题",data:[],selectId:null,index:1},this.itemNum=this.datamodel.data.length,this.displayNum=5,this.scroll=null,this.events={"click .cui-select-view> li":"clickAction"},this.onClick=function(a,b){0}},resetPropery:function(){this._resetNum(),this._resetIndex()},_resetIndex:function(){if(this.datamodel.selectId)for(var a=0,b=this.datamodel.data.length;b>a;a++)if(this.datamodel.selectId==this.datamodel.data[a].id){this.datamodel.index=a;break}},_resetNum:function(){this.displayNum=this.displayNum%2==0?this.displayNum+1:this.displayNum,this.itemNum=this.datamodel.data.length},clickAction:function(a){var b=$(a.currentTarget),c=b.attr("data-index");this.setIndex(c),this.onClick&&this.onClick.call(this,a,this.getSelected())},setId:function(a){if(a){var b,c,d=-1;for(b=0,c=this.datamodel.data.length;c>b;b++)if(this.datamodel.data[b].id==a){d=b;break}-1!=d&&(this.datamodel.selectId=a,this.datamodel.index=d,this.setIndex(d))}},setDatamodel:function(a){_.extend(this.datamodel,a),this.itemNum=this.datamodel.data.length,this.refresh()},getId:function(){return this.datamodel.selectId},setIndex:function(a,b){a=parseInt(a),0>a||a>=this.datamodel.data.length||(this.datamodel.index=a,this.datamodel.selectId=this.datamodel.data[a].id,this.$("li").removeClass("current"),this.$('li[data-index="'+a+'"]').addClass("current"),b&&this._position())},getIndex:function(){return this.datamodel.index},getSelected:function(){return this.datamodel.data[this.datamodel.index]},initElement:function(){this.swrapper=this.$(".cui-bd"),this.scroller=this.$(".cui-select-view")},initSize:function(){var a=this.displayNum;this.sheight=this.scroller.height(),this.itemHeight=parseInt(this.sheight/this.itemNum),a>this.itemNum&&(a=this.itemNum),this.swrapper.height(this.itemHeight*a)},_position:function(){if(this.scroll){var a,b=this.datamodel.index;this.itemNum-b<this.displayNum&&(b=this.itemNum-this.displayNum),a=this.itemHeight*b*-1,this.scroll.scrollTo(0,a)}},initialize:function($super,a){$super(a)},addEvent:function($super){$super(),this.on("onShow",function(){this.initSize(),this.scroll&&this.scroll.destory&&this.scroll.destory(),this.itemNum>this.displayNum&&(this.scroll=new c({wrapper:this.swrapper,scroller:this.scroller}),this._position())},1),this.on("onHide",function(){this.scroll&&(this.scroll.destroy(),this.scroll=null)})}})});